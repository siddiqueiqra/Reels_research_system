<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reels Research System</title>
  <base target="_top">
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    :root {
      --primary-pink: #FF6B9D;
      --primary-peach: #FF8C61;
      --primary-purple: #9D4EDD;
      --primary-coral: #FF7B9C;
      --accent-rose: #FF5C8D;
      --accent-gold: #FFB347;
      --bg-base: #1A1625;
      --bg-soft: #241D2F;
      --bg-card: #2D2438;
      --bg-elevated: #372D44;
      --text-primary: #FFFFFF;
      --text-secondary: #E5E1EA;
      --text-tertiary: #B8B0C7;
      --text-muted: #8B7E9D;
      --white: #FFFFFF;
      --shadow-soft: 0 8px 32px rgba(0, 0, 0, 0.4);
      --shadow-medium: 0 16px 48px rgba(0, 0, 0, 0.5);
      --shadow-dreamy: 0 20px 60px rgba(157, 78, 221, 0.3);
      --shadow-glow: 0 0 30px rgba(255, 107, 157, 0.4);
    }

    body {
      font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
      background: linear-gradient(135deg, var(--bg-base) 0%, #1F1833 50%, var(--bg-soft) 100%);
      color: var(--text-primary);
      position: relative;
      overflow-x: hidden;
      font-size: 15px;
      line-height: 1.6;
      min-height: 100vh;
    }

    .bg-orbs {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      z-index: -1;
      overflow: hidden;
      pointer-events: none;
    }

    .orb {
      position: absolute;
      border-radius: 50%;
      filter: blur(100px);
      opacity: 0.3;
      animation: float 25s infinite ease-in-out;
      mix-blend-mode: screen;
    }

    .orb-1 {
      width: 700px;
      height: 700px;
      background: radial-gradient(circle, rgba(157, 78, 221, 0.4), rgba(255, 107, 157, 0.2));
      top: -250px;
      left: -250px;
      animation-delay: 0s;
    }

    .orb-2 {
      width: 600px;
      height: 600px;
      background: radial-gradient(circle, rgba(255, 140, 97, 0.3), rgba(157, 78, 221, 0.2));
      bottom: -200px;
      right: -200px;
      animation-delay: 7s;
    }

    @keyframes float {
      0%, 100% {
        transform: translate(0, 0) scale(1);
        opacity: 0.3;
      }
      25% {
        transform: translate(40px, -40px) scale(1.08);
        opacity: 0.4;
      }
      50% {
        transform: translate(-30px, 30px) scale(0.92);
        opacity: 0.25;
      }
      75% {
        transform: translate(30px, 40px) scale(1.05);
        opacity: 0.35;
      }
    }

    .login-page {
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
      padding: 20px;
    }

    .login-container {
      background: rgba(45, 36, 56, 0.95);
      backdrop-filter: blur(30px);
      border-radius: 32px;
      padding: 60px 50px;
      box-shadow: var(--shadow-dreamy);
      border: 1px solid rgba(157, 78, 221, 0.3);
      max-width: 450px;
      width: 100%;
      animation: fadeInUp 0.8s ease;
    }

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(40px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .login-header {
      text-align: center;
      margin-bottom: 40px;
    }

    .login-icon {
      font-size: 72px;
      margin-bottom: 20px;
      animation: pulse 3s ease-in-out infinite;
      filter: drop-shadow(0 4px 20px rgba(255, 107, 157, 0.6));
    }

    @keyframes pulse {
      0%, 100% {
        transform: scale(1);
      }
      50% {
        transform: scale(1.08);
      }
    }

    .login-title {
      font-size: 38px;
      font-weight: 800;
      background: linear-gradient(135deg, var(--primary-pink), var(--accent-gold), var(--primary-purple));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      margin-bottom: 8px;
    }

    .login-subtitle {
      color: var(--text-tertiary);
      font-size: 14px;
      font-weight: 600;
    }

    .form-group {
      margin-bottom: 24px;
    }

    .form-label {
      display: block;
      font-size: 14px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 8px;
    }

    .form-input {
      width: 100%;
      padding: 14px 18px;
      border: 2px solid rgba(157, 78, 221, 0.3);
      border-radius: 16px;
      font-size: 15px;
      font-family: 'Inter', sans-serif;
      background: rgba(55, 45, 68, 0.8);
      transition: all 0.3s ease;
      color: var(--text-primary);
      font-weight: 600;
    }

    .form-input:focus {
      outline: none;
      border-color: var(--primary-pink);
      box-shadow: 0 0 0 4px rgba(255, 107, 157, 0.2);
      background: var(--bg-elevated);
    }

    .btn-login {
      width: 100%;
      padding: 16px;
      background: linear-gradient(135deg, var(--primary-pink), var(--primary-purple));
      color: var(--white);
      border: none;
      border-radius: 16px;
      font-size: 15px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      box-shadow: var(--shadow-glow);
    }

    .btn-login:hover {
      transform: translateY(-2px);
    }

    .btn-login:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .app-container {
      display: none;
    }

    .app-container.active {
      display: block;
    }

    .app-header {
      background: rgba(45, 36, 56, 0.95);
      backdrop-filter: blur(30px);
      border-bottom: 1px solid rgba(157, 78, 221, 0.3);
      padding: 20px 40px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: var(--shadow-soft);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .app-logo {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .app-logo-icon {
      font-size: 32px;
    }

    .app-logo-text {
      font-size: 24px;
      font-weight: 800;
      background: linear-gradient(135deg, var(--primary-pink), var(--accent-gold));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .app-user {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .user-info {
      display: flex;
      align-items: center;
      gap: 12px;
      padding: 8px 16px;
      background: rgba(157, 78, 221, 0.2);
      border-radius: 20px;
      border: 1px solid rgba(157, 78, 221, 0.3);
    }

    .user-avatar {
      width: 36px;
      height: 36px;
      border-radius: 50%;
      background: linear-gradient(135deg, var(--primary-pink), var(--primary-purple));
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--white);
      font-weight: 700;
      font-size: 14px;
    }

    .user-name {
      font-size: 14px;
      font-weight: 700;
      color: var(--text-primary);
    }

    .btn-logout {
      padding: 10px 20px;
      background: linear-gradient(135deg, #FF5C5C, #FF8C61);
      color: var(--white);
      border: none;
      border-radius: 12px;
      font-size: 13px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .app-nav {
      background: rgba(45, 36, 56, 0.95);
      backdrop-filter: blur(30px);
      border-bottom: 1px solid rgba(157, 78, 221, 0.3);
      padding: 0 40px;
      display: flex;
      gap: 8px;
    }

    .nav-item {
      padding: 16px 24px;
      background: transparent;
      border: none;
      color: var(--text-tertiary);
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      border-bottom: 3px solid transparent;
      transition: all 0.3s ease;
      font-family: 'Inter', sans-serif;
    }

    .nav-item:hover {
      color: var(--text-primary);
      background: rgba(157, 78, 221, 0.15);
    }

    .nav-item.active {
      color: var(--primary-pink);
      border-bottom-color: var(--primary-pink);
      background: rgba(255, 107, 157, 0.15);
    }

    .app-main {
      padding: 40px;
      max-width: 1600px;
      margin: 0 auto;
    }

    .page-section {
      display: none;
    }

    .page-section.active {
      display: block;
      animation: fadeIn 0.6s ease;
    }

    @keyframes fadeIn {
      from {
        opacity: 0;
      }
      to {
        opacity: 1;
      }
    }

    .stats-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 24px;
      margin-bottom: 40px;
    }

    .stat-card {
      background: rgba(45, 36, 56, 0.95);
      backdrop-filter: blur(30px);
      border-radius: 24px;
      padding: 32px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(157, 78, 221, 0.3);
      transition: all 0.3s ease;
    }

    .stat-card:hover {
      transform: translateY(-8px);
      box-shadow: var(--shadow-dreamy);
    }

    .stat-icon {
      font-size: 40px;
      margin-bottom: 16px;
    }

    .stat-value {
      font-size: 48px;
      font-weight: 800;
      background: linear-gradient(135deg, var(--primary-pink), var(--accent-gold));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 8px;
    }

    .stat-label {
      font-size: 14px;
      color: var(--text-tertiary);
      font-weight: 700;
    }

    .action-buttons {
      display: flex;
      gap: 16px;
      margin-bottom: 40px;
      flex-wrap: wrap;
    }

    .btn {
      padding: 14px 28px;
      border: none;
      border-radius: 16px;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      font-family: 'Inter', sans-serif;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary-pink), var(--primary-purple));
      color: var(--white);
      box-shadow: var(--shadow-glow);
    }

    .btn-primary:hover {
      transform: translateY(-2px);
    }

    .btn-secondary {
      background: rgba(157, 78, 221, 0.2);
      color: var(--primary-pink);
      border: 2px solid rgba(157, 78, 221, 0.4);
    }

    .btn-gradient {
      background: linear-gradient(135deg, var(--primary-pink), var(--primary-purple));
      color: var(--white);
      padding: 12px 24px;
      border: none;
      border-radius: 12px;
      font-size: 14px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-gradient:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-glow);
    }

    .btn-gradient:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }

    .research-form {
      background: rgba(45, 36, 56, 0.95);
      backdrop-filter: blur(30px);
      border-radius: 24px;
      padding: 40px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(157, 78, 221, 0.3);
      margin-bottom: 32px;
      display: none;
    }

    .form-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
      gap: 24px;
      margin-bottom: 24px;
    }

    .form-group-full {
      grid-column: 1 / -1;
    }

    textarea.form-input {
      min-height: 120px;
      resize: vertical;
    }

    select.form-input {
      cursor: pointer;
    }

    .table-container {
      background: rgba(45, 36, 56, 0.95);
      backdrop-filter: blur(30px);
      border-radius: 24px;
      padding: 32px;
      box-shadow: var(--shadow-soft);
      border: 1px solid rgba(157, 78, 221, 0.3);
    }

    .section-title {
      font-size: 32px;
      font-weight: 800;
      color: var(--text-primary);
      margin-bottom: 24px;
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .table-controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 24px;
      flex-wrap: wrap;
      gap: 16px;
    }

    .search-box {
      position: relative;
      flex: 1;
      min-width: 300px;
      max-width: 500px;
    }

    .table-wrapper {
      overflow-x: auto;
      border-radius: 16px;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      min-width: 1000px;
    }

    thead {
      background: linear-gradient(135deg, rgba(157, 78, 221, 0.2), rgba(255, 107, 157, 0.2));
    }

    th {
      padding: 16px;
      text-align: left;
      font-weight: 700;
      font-size: 13px;
      color: var(--text-primary);
      white-space: nowrap;
    }

    tbody tr {
      border-bottom: 1px solid rgba(157, 78, 221, 0.2);
      transition: all 0.3s ease;
    }

    tbody tr:hover {
      background: rgba(157, 78, 221, 0.15);
    }

    td {
      padding: 16px;
      font-size: 14px;
      color: var(--text-secondary);
      font-weight: 600;
    }

    .outlier-badge {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 700;
      white-space: nowrap;
    }

    .outlier-hook {
      background: rgba(255, 107, 157, 0.25);
      color: #FFB5D8;
    }

    .outlier-music {
      background: rgba(255, 140, 97, 0.25);
      color: #FFB396;
    }

    .outlier-script {
      background: rgba(157, 78, 221, 0.25);
      color: #C9A7E8;
    }

    .outlier-shootingstyle {
      background: rgba(255, 179, 71, 0.25);
      color: #FFD08C;
    }

    .outlier-fullreel {
      background: rgba(255, 123, 156, 0.25);
      color: #FFAAC9;
    }

    .outlier-topic {
      background: rgba(255, 179, 71, 0.25);
      color: #FFD08C;
    }

    .status-badge {
      display: inline-block;
      padding: 6px 12px;
      border-radius: 20px;
      font-size: 11px;
      font-weight: 700;
    }

    .status-pending {
      background: rgba(255, 179, 71, 0.3);
      color: #FFD08C;
    }

    .status-approved {
      background: rgba(76, 175, 80, 0.3);
      color: #A5D6A7;
    }

    .status-rejected {
      background: rgba(244, 67, 54, 0.3);
      color: #EF9A9A;
    }

    .btn-icon {
      padding: 8px 16px;
      border: none;
      border-radius: 10px;
      font-size: 12px;
      font-weight: 700;
      cursor: pointer;
      transition: all 0.3s ease;
      margin-right: 8px;
    }

    .btn-view {
      background: rgba(255, 140, 97, 0.25);
      color: #FFB396;
    }

    .btn-edit {
      background: rgba(255, 107, 157, 0.25);
      color: #FFB5D8;
    }

    .btn-delete {
      background: rgba(244, 67, 54, 0.25);
      color: #EF9A9A;
    }

    .message {
      padding: 16px 24px;
      border-radius: 16px;
      margin-bottom: 24px;
      display: none;
      font-weight: 700;
    }

    .message.active {
      display: block;
      animation: slideIn 0.4s ease;
    }

    @keyframes slideIn {
      from {
        opacity: 0;
        transform: translateY(-20px);
      }
    }

    .message.success {
      background: rgba(76, 175, 80, 0.3);
      color: #A5D6A7;
      border: 2px solid rgba(76, 175, 80, 0.5);
    }

    .message.error {
      background: rgba(244, 67, 54, 0.3);
      color: #EF9A9A;
      border: 2px solid rgba(244, 67, 54, 0.5);
    }

    .loading {
      text-align: center;
      padding: 60px 20px;
    }

    .spinner {
      width: 60px;
      height: 60px;
      margin: 0 auto 24px;
      border: 4px solid rgba(157, 78, 221, 0.3);
      border-top: 4px solid var(--primary-pink);
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    @keyframes spin {
      0% {
        transform: rotate(0deg);
      }
      100% {
        transform: rotate(360deg);
      }
    }

    .empty-state {
      text-align: center;
      padding: 80px 20px;
    }

    .empty-icon {
      font-size: 80px;
      opacity: 0.3;
      margin-bottom: 24px;
    }

    .empty-title {
      font-size: 24px;
      font-weight: 700;
      color: var(--text-primary);
      margin-bottom: 12px;
    }

    .empty-text {
      font-size: 14px;
      color: var(--text-tertiary);
      font-weight: 600;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(26, 22, 37, 0.9);
      backdrop-filter: blur(10px);
      z-index: 1000;
      overflow-y: auto;
      padding: 40px 20px;
    }

    .modal.active {
      display: flex;
      align-items: center;
      justify-content: center;
      animation: fadeIn 0.3s ease;
    }

    .modal-content {
      background: rgba(45, 36, 56, 0.98);
      backdrop-filter: blur(30px);
      border-radius: 32px;
      max-width: 1200px;
      width: 100%;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: var(--shadow-dreamy);
      border: 1px solid rgba(157, 78, 221, 0.3);
    }

    .modal-header {
      background: linear-gradient(135deg, var(--primary-pink), var(--primary-purple));
      color: var(--white);
      padding: 32px 40px;
      border-radius: 32px 32px 0 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .modal-title {
      font-size: 28px;
      font-weight: 800;
    }

    .btn-close {
      background: rgba(255, 255, 255, 0.25);
      border: none;
      width: 40px;
      height: 40px;
      border-radius: 50%;
      color: var(--white);
      font-size: 24px;
      cursor: pointer;
      transition: all 0.3s ease;
    }

    .btn-close:hover {
      background: rgba(255, 255, 255, 0.35);
      transform: rotate(90deg);
    }

    .modal-body {
      padding: 40px;
    }

    @media (max-width: 768px) {
      .app-header,
      .app-nav,
      .app-main {
        padding: 16px 20px;
      }

      .stats-grid {
        grid-template-columns: 1fr;
      }

      .form-grid {
        grid-template-columns: 1fr;
      }
    }
  </style>
</head>

<body>
  <div class="bg-orbs">
    <div class="orb orb-1"></div>
    <div class="orb orb-2"></div>
  </div>

  <!-- Login Page -->
  <div class="login-page" id="loginPage">
    <div class="login-container">
      <div class="login-header">
        <div class="login-icon">üé¨</div>
        <h1 class="login-title">REELS RESEARCH</h1>
        <p class="login-subtitle">Content Research System</p>
      </div>

      <form id="loginForm">
        <div class="form-group">
          <label class="form-label">Username</label>
          <input type="text" class="form-input" id="username" placeholder="Enter username" required>
        </div>

        <div class="form-group">
          <label class="form-label">Password</label>
          <input type="password" class="form-input" id="password" placeholder="Enter password" required>
        </div>

        <button type="submit" class="btn-login" id="loginBtn">Login</button>
      </form>

      <div style="margin-top: 24px; text-align: center; color: var(--text-muted); font-size: 13px;">
        Welcome Content Creator
      </div>
    </div>
  </div>

  <!-- Main App -->
  <div class="app-container" id="appContainer">
    <header class="app-header">
      <div class="app-logo">
        <span class="app-logo-icon">üé¨</span>
        <span class="app-logo-text">Reels Research Hub</span>
      </div>

      <div class="app-user">
        <div class="user-info">
          <div class="user-avatar" id="userAvatar">U</div>
          <span class="user-name" id="userName">User</span>
        </div>
        <button class="btn-logout" id="logoutBtn">Logout</button>
      </div>
    </header>

    <nav class="app-nav">
      <button class="nav-item active" data-page="dashboard">Dashboard</button>
      <button class="nav-item" data-page="research">Research</button>
      <button class="nav-item" data-page="production">Production</button>
    </nav>

    <main class="app-main">
      <div class="message" id="message"></div>

      <!-- Dashboard -->
      <section class="page-section active" id="dashboardPage">
        <div class="stats-grid">
          <div class="stat-card">
            <div class="stat-icon">üìä</div>
            <div class="stat-value" id="totalReels">0</div>
            <div class="stat-label">Total Reels</div>
          </div>

          <div class="stat-card">
            <div class="stat-icon">‚è≥</div>
            <div class="stat-value" id="pendingReview">0</div>
            <div class="stat-label">Pending Review</div>
          </div>

          <div class="stat-card">
            <div class="stat-icon">‚úÖ</div>
            <div class="stat-value" id="approvedIdeas">0</div>
            <div class="stat-label">Approved Ideas</div>
          </div>

          <div class="stat-card">
            <div class="stat-icon">üìÖ</div>
            <div class="stat-value" id="thisWeek">0</div>
            <div class="stat-label">This Week</div>
          </div>
        </div>

        <div class="action-buttons">
          <button class="btn btn-primary" id="addNewResearch">
            <span>+</span>
            <span>Add Research</span>
          </button>
          <button class="btn btn-secondary" data-page="research">
            <span>üìã</span>
            <span>View All</span>
          </button>
        </div>
      </section>

      <!-- Research Page -->
      <section class="page-section" id="researchPage">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
          <h2>üîç Research Collection</h2>
          <button id="refreshResearchBtn" class="btn-gradient">üîÅ Refresh</button>
        </div>

        <div class="research-form" id="researchForm">
          <h3 style="font-size: 24px; margin-bottom: 32px; color: var(--text-primary); font-weight: 700;">
            Add New Research
          </h3>

          <form id="addResearchForm">
            <div class="form-grid">
              <div class="form-group">
                <label class="form-label">Account Name *</label>
                <input type="text" class="form-input" id="accountName" required>
              </div>

              <div class="form-group">
                <label class="form-label">Category *</label>
                <select class="form-input" id="category" required>
                  <option value="">Select</option>
                  <option>Patch</option>
                  <option>Extensions</option>
                  <option>Personal Brand</option>
                  <option>Salon</option>
                </select>
              </div>

              <div class="form-group">
                <label class="form-label">Source Type *</label>
                <select class="form-input" id="sourceType" required>
                  <option value="">Select</option>
                  <option>Competitor</option>
                  <option>Influencer</option>
                  <option>Outlier</option>
                  <option>Trending/Meme</option>
                </select>
              </div>

              <div class="form-group">
                <label class="form-label">Outlier Category *</label>
                <select class="form-input" id="outlierCategory" required>
                  <option value="">Select</option>
                  <option>Hook</option>
                  <option>Topic</option>
                  <option>Music</option>
                  <option>Shooting Style</option>
                  <option>Script</option>
                  <option>Full Reel</option>
                </select>
              </div>

              <div class="form-group">
                <label class="form-label">Shooting Style</label>
                <select class="form-input" id="shootingStyle">
                  <option value="">Select</option>
                  <option>Talk-to-camera</option>
                  <option>Before-after</option>
                  <option>Meme</option>
                  <option>Storytelling</option>
                  <option>Transformation</option>
                </select>
              </div>

              <div class="form-group">
                <label class="form-label">Link to Reel *</label>
                <input type="url" class="form-input" id="reelLink" required>
              </div>

              <div class="form-group form-group-full">
                <label class="form-label">Hook / Opening Line</label>
                <input type="text" class="form-input" id="hook">
              </div>

              <div class="form-group form-group-full">
                <label class="form-label">Topic / Subject</label>
                <input type="text" class="form-input" id="topic">
              </div>

              <div class="form-group">
                <label class="form-label">Music / Audio</label>
                <input type="text" class="form-input" id="music">
              </div>

              <div class="form-group">
                <label class="form-label">Brolls / Text</label>
                <input type="text" class="form-input" id="brolls">
              </div>

              <div class="form-group form-group-full">
                <label class="form-label">Why It Outperformed</label>
                <textarea class="form-input" id="whyOutperformed"></textarea>
              </div>

              <div class="form-group form-group-full">
                <label class="form-label">How We Can Recreate</label>
                <textarea class="form-input" id="howRecreate"></textarea>
              </div>

              <div class="form-group form-group-full">
                <label class="form-label">Notes / Tags</label>
                <input type="text" class="form-input" id="notes">
              </div>
            </div>

            <div style="display: flex; gap: 16px; margin-top: 32px;">
              <button type="button" class="btn btn-secondary" id="cancelResearch">Cancel</button>
              <button type="submit" class="btn btn-primary">Save Research</button>
            </div>
          </form>
        </div>

        <div class="table-container">
          <div class="table-controls">
            <h3 style="font-size: 18px; font-weight: 700;">
              Items (<span id="researchCount">0</span>)
            </h3>

            <div class="search-box">
              <input type="text" class="form-input" id="searchResearch" placeholder="Search...">
            </div>

            <button class="btn btn-primary" id="toggleFormBtn">+ Add Research</button>
          </div>

          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Account</th>
                  <th>Category</th>
                  <th>Outlier</th>
                  <th>Hook</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="researchTableBody"></tbody>
            </table>
          </div>

          <div class="empty-state" id="researchEmpty" style="display: none;">
            <div class="empty-icon">üì¶</div>
            <h3 class="empty-title">No Research Yet</h3>
            <p class="empty-text">Click "Add Research" to start</p>
          </div>
        </div>
      </section>

      <!-- Production Page -->
      <section class="page-section" id="productionPage">
        <h2 class="section-title">
          <span>‚ú®</span>
          Production
        </h2>

        <div class="table-container">
          <div class="table-controls">
            <h3 style="font-size: 18px; font-weight: 700;">
              Items (<span id="productionCount">0</span>)
            </h3>
          </div>

          <div class="table-wrapper">
            <table>
              <thead>
                <tr>
                  <th>Date</th>
                  <th>Account</th>
                  <th>Category</th>
                  <th>Outlier</th>
                  <th>Hook</th>
                  <th>Script</th>
                  <th>Status</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody id="productionTableBody"></tbody>
            </table>
          </div>

          <div class="empty-state" id="productionEmpty" style="display: none;">
            <div class="empty-icon">‚ú®</div>
            <h3 class="empty-title">No Production Items</h3>
            <p class="empty-text">Approve research items first</p>
          </div>
        </div>
      </section>
    </main>
  </div>

  <!-- Edit Modal -->
  <div class="modal" id="editModal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="modal-title">Edit Research</h2>
        <button class="btn-close" id="closeEditModal">√ó</button>
      </div>

      <div class="modal-body">
        <form id="editResearchForm">
          <input type="hidden" id="editItemId">

          <div class="form-grid">
            <div class="form-group">
              <label class="form-label">Account Name</label>
              <input type="text" class="form-input" id="editAccountName">
            </div>

            <div class="form-group">
              <label class="form-label">Category</label>
              <select class="form-input" id="editCategory">
                <option>Patch</option>
                <option>Extensions</option>
                <option>Personal Brand</option>
                <option>Salon</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label">Source Type</label>
              <select class="form-input" id="editSourceType">
                <option>Competitor</option>
                <option>Influencer</option>
                <option>Outlier</option>
                <option>Trending/Meme</option>
              </select>
            </div>

            <div class="form-group">
              <label class="form-label">Outlier Category</label>
              <select class="form-input" id="editOutlierCategory">
                <option>Hook</option>
                <option>Topic</option>
                <option>Music</option>
                <option>Shooting Style</option>
                <option>Script</option>
                <option>Full Reel</option>
              </select>
            </div>

            <div class="form-group form-group-full">
              <label class="form-label">Hook</label>
              <textarea class="form-input" id="editHook"></textarea>
            </div>

            <div class="form-group form-group-full">
              <label class="form-label">Topic</label>
              <textarea class="form-input" id="editTopic"></textarea>
            </div>

            <div class="form-group">
              <label class="form-label">Music</label>
              <input type="text" class="form-input" id="editMusic">
            </div>

            <div class="form-group">
              <label class="form-label">Shooting Style</label>
              <select class="form-input" id="editShootingStyle">
                <option>Talk-to-camera</option>
                <option>Before-after</option>
                <option>Meme</option>
                <option>Storytelling</option>
                <option>Transformation</option>
              </select>
            </div>

            <div class="form-group form-group-full">
              <label class="form-label">Link</label>
              <input type="url" class="form-input" id="editReelLink">
            </div>

            <div class="form-group form-group-full">
              <label class="form-label">Why Outperformed</label>
              <textarea class="form-input" id="editWhyOutperformed"></textarea>
            </div>

            <div class="form-group form-group-full">
              <label class="form-label">How to Recreate</label>
              <textarea class="form-input" id="editHowRecreate"></textarea>
            </div>

            <div class="form-group form-group-full">
              <label class="form-label">Notes</label>
              <input type="text" class="form-input" id="editNotes">
            </div>

            <div class="form-group">
              <label class="form-label">Status</label>
              <select class="form-input" id="editStatus">
                <option value="Pending">Pending</option>
                <option value="Approved">Approved</option>
                <option value="Rejected">Rejected</option>
              </select>
            </div>
          </div>

          <div style="display: flex; gap: 16px; justify-content: flex-end; margin-top: 32px;">
            <button type="button" class="btn btn-secondary" id="cancelEdit">Cancel</button>
            <button type="submit" class="btn btn-primary">Save Changes</button>
          </div>
        </form>
      </div>
    </div>
  </div>

  <script>
    let currentUser = null;
    let researchData = [];
    let productionData = [];

    // Wait for DOM to be fully loaded
    document.addEventListener('DOMContentLoaded', function() {
      console.log('DOM loaded');
    });

    // Login
    document.getElementById('loginForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      const btn = document.getElementById('loginBtn');
      btn.disabled = true;
      btn.textContent = 'Logging in...';
      
      const username = document.getElementById('username').value;
      const password = document.getElementById('password').value;
      
      try {
        const result = await googleScriptRun('authenticateUser', username, password);
        console.log('Auth result:', result);
        
        if (result && result.success) {
          currentUser = result.user;
          showApp();
        } else {
          showMessage(result.message || 'Login failed', 'error');
        }
      } catch (error) {
        console.error('Login error:', error);
        showMessage('Error: ' + error, 'error');
      } finally {
        btn.disabled = false;
        btn.textContent = 'Login';
      }
    });

    // Logout
    document.getElementById('logoutBtn').addEventListener('click', function() {
      currentUser = null;
      researchData = [];
      productionData = [];
      document.getElementById('loginPage').style.display = 'flex';
      document.getElementById('appContainer').classList.remove('active');
      document.getElementById('loginForm').reset();
    });

    function showApp() {
      console.log('Showing app for user:', currentUser);
      document.getElementById('loginPage').style.display = 'none';
      document.getElementById('appContainer').classList.add('active');
      document.getElementById('userName').textContent = currentUser.name;
      document.getElementById('userAvatar').textContent = currentUser.avatar;
      
      // Load data immediately
      setTimeout(() => {
        console.log('Loading data...');
        loadData();
      }, 100);
    }
    
    async function loadData() {
      console.log('loadData called');
      try {
        await loadStats();
        await loadResearch();
        await loadProduction();
        console.log('All data loaded');
      } catch (error) {
        console.error('Error in loadData:', error);
        showMessage('Error loading data: ' + error.toString(), 'error');
      }
    }

    async function loadStats() {
      try {
        console.log('Loading stats...');
        const result = await googleScriptRun('getStats');
        console.log('Stats result:', result);
        
        if (result && result.success) {
          document.getElementById('totalReels').textContent = result.stats.total || 0;
          document.getElementById('pendingReview').textContent = result.stats.pending || 0;
          document.getElementById('approvedIdeas').textContent = result.stats.approved || 0;
          document.getElementById('thisWeek').textContent = result.stats.thisWeek || 0;
        }
      } catch (error) {
        console.error('Error loading stats:', error);
      }
    }

    // FIXED: Load Research with comprehensive error handling
    async function loadResearch() {
      console.log('=== LOAD RESEARCH START ===');
      console.log('Current user:', currentUser);
      
      if (!currentUser?.name) {
        console.error('‚ùå No user logged in');
        showMessage('Please login first', 'error');
        return;
      }

      try {
        console.log('üìû Calling getAllResearch with username:', currentUser.name);
        
        const result = await new Promise((resolve, reject) => {
          console.log('üîÑ Setting up google.script.run call...');
          
          const timeoutId = setTimeout(() => {
            console.error('‚è∞ Call timed out after 10 seconds');
            reject(new Error('Call timed out'));
          }, 10000);
          
          google.script.run
            .withSuccessHandler(function(result) {
              clearTimeout(timeoutId);
              console.log('‚úÖ SUCCESS HANDLER CALLED');
              console.log('Result received:', result);
              console.log('Result type:', typeof result);
              console.log('Result is null:', result === null);
              console.log('Result is undefined:', result === undefined);
              
              if (result === null || result === undefined) {
                console.error('‚ùå Result is null/undefined!');
                reject(new Error('getAllResearch returned null'));
                return;
              }
              
              resolve(result);
            })
            .withFailureHandler(function(error) {
              clearTimeout(timeoutId);
              console.error('‚ùå FAILURE HANDLER CALLED');
              console.error('Error:', error);
              reject(error);
            })
            .getAllResearch(String(currentUser.name));
          
          console.log('üì§ google.script.run call initiated');
        });
        
        console.log('üì¶ Promise resolved with:', result);
        
        if (!result) {
          throw new Error('getAllResearch returned no data');
        }
        
        if (!result.success) {
          throw new Error(result.message || 'Backend returned error status');
        }
        
        if (!Array.isArray(result.data)) {
          console.error('Result.data is not an array:', result.data);
          throw new Error('Backend returned invalid data format');
        }
        
        researchData = result.data;
        console.log('‚úÖ Successfully loaded', researchData.length, 'items');
        console.log('First item:', researchData[0]);
        
        renderResearch();
        showMessage(`Loaded ${researchData.length} research items`, 'success');
        
      } catch (error) {
        console.error('‚ùå EXCEPTION in loadResearch:', error);
        console.error('Error stack:', error.stack);
        
        researchData = [];
        renderResearch();
        showMessage('Error loading research: ' + error.message, 'error');
      }
      
      console.log('=== LOAD RESEARCH END ===');
    }

    // FIXED: Render Research with safe HTML escaping
    function renderResearch() {
      console.log('üé® Rendering', researchData?.length || 0, 'items');
      
      const tbody = document.getElementById('researchTableBody');
      const empty = document.getElementById('researchEmpty');
      const count = document.getElementById('researchCount');
      const tableWrapper = document.querySelector('#researchPage .table-wrapper');
      
      if (!tbody) {
        console.error('‚ùå Table body not found!');
        alert('ERROR: Table element not found. Check HTML structure.');
        return;
      }
      
      count.textContent = researchData?.length || 0;
      
      if (!researchData || researchData.length === 0) {
        tbody.innerHTML = '';
        if (empty) empty.style.display = 'block';
        if (tableWrapper) tableWrapper.style.display = 'none';
        return;
      }
      
      if (empty) empty.style.display = 'none';
      if (tableWrapper) tableWrapper.style.display = 'block';
      
      try {
        let html = '';
        
        for (let i = 0; i < researchData.length; i++) {
          const item = researchData[i];
          
          let date = 'N/A';
          try {
            if (item.dateAdded) {
              const d = new Date(item.dateAdded);
              if (!isNaN(d.getTime())) date = d.toLocaleDateString();
            }
          } catch (e) {
            console.warn('Date parsing error:', e);
          }
          
          const safeStr = (str) => {
            if (!str) return '';
            return String(str).replace(/[<>&"']/g, (c) => {
              return {'<':'&lt;', '>':'&gt;', '&':'&amp;', '"':'&quot;', "'":"&#39;"}[c];
            });
          };
          
          const outlierClass = (item.outlierCategory || '')
            .toLowerCase()
            .replace(/\s+/g, '')
            .replace(/[^a-z0-9]/g, '');
          
          const statusClass = (item.status || 'pending')
            .toLowerCase()
            .replace(/\s+/g, '');
          
          html += `
            <tr>
              <td>${date}</td>
              <td>${safeStr(item.accountName) || 'N/A'}</td>
              <td>${safeStr(item.category) || 'N/A'}</td>
              <td><span class="outlier-badge outlier-${outlierClass}">${safeStr(item.outlierCategory) || 'N/A'}</span></td>
              <td style="max-width: 200px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                ${safeStr(item.hook) || '-'}
              </td>
              <td><span class="status-badge status-${statusClass}">${safeStr(item.status) || 'Pending'}</span></td>
              <td style="white-space: nowrap;">
                <button class="btn-icon btn-view" onclick="window.open('${safeStr(item.reelLink)}', '_blank')" ${!item.reelLink ? 'disabled' : ''}>üëÅÔ∏è</button>
                <button class="btn-icon btn-edit" onclick="editItem(${item.id})">‚úèÔ∏è</button>
                <button class="btn-icon btn-delete" onclick="deleteItem(${item.id})">üóëÔ∏è</button>
              </td>
            </tr>
          `;
        }
        
        tbody.innerHTML = html;
        console.log('‚úÖ Rendered', tbody.children.length, 'rows');
        
      } catch (error) {
        console.error('‚ùå Error rendering table:', error);
        tbody.innerHTML = `
          <tr>
            <td colspan="7" style="text-align: center; color: red; padding: 20px;">
              Error rendering data: ${error.toString()}
            </td>
          </tr>
        `;
      }
    }

    async function loadProduction() {
      try {
        console.log('Loading production...');
        const result = await googleScriptRun('getAllProduction');
        console.log('Production result:', result);
        
        if (result && result.success) {
          productionData = result.data || [];
          renderProduction();
        } else {
          productionData = [];
          renderProduction();
        }
      } catch (error) {
        console.error('Error loading production:', error);
        productionData = [];
        renderProduction();
      }
    }

    function renderProduction() {
      const tbody = document.getElementById('productionTableBody');
      const empty = document.getElementById('productionEmpty');
      const count = document.getElementById('productionCount');
      const tableWrapper = document.querySelector('#productionPage .table-wrapper');
      
      count.textContent = productionData.length;
      
      if (productionData.length === 0) {
        tbody.innerHTML = '';
        if (empty) empty.style.display = 'block';
        if (tableWrapper) tableWrapper.style.display = 'none';
        return;
      }
      
      if (empty) empty.style.display = 'none';
      if (tableWrapper) tableWrapper.style.display = 'block';
      
      tbody.innerHTML = productionData.map(item => `
        <tr>
          <td>${item.dateAdded ? new Date(item.dateAdded).toLocaleDateString() : 'N/A'}</td>
          <td>${item.accountName || 'N/A'}</td>
          <td>${item.category || 'N/A'}</td>
          <td><span class="outlier-badge outlier-${(item.outlierCategory || '').toLowerCase().replace(/\s+/g, '')}">${item.outlierCategory || 'N/A'}</span></td>
          <td style="max-width: 200px;">${item.hook || '-'}</td>
          <td><span class="status-badge ${item.mainScript ? 'status-approved' : 'status-pending'}">${item.mainScript ? 'Done' : 'Pending'}</span></td>
          <td><span class="status-badge status-${(item.prodStatus || 'draft').toLowerCase()}">${item.prodStatus || 'Draft'}</span></td>
          <td>
            <button class="btn-icon btn-view" onclick="window.open('${item.reelLink}', '_blank')">üëÅÔ∏è</button>
          </td>
        </tr>
      `).join('');
    }

    // Add Research
    document.getElementById('addNewResearch').addEventListener('click', function() {
      switchPage('research');
      document.getElementById('researchForm').style.display = 'block';
      document.getElementById('researchForm').scrollIntoView({ behavior: 'smooth' });
    });

    document.getElementById('toggleFormBtn').addEventListener('click', function() {
      const form = document.getElementById('researchForm');
      form.style.display = form.style.display === 'none' ? 'block' : 'none';
      if (form.style.display === 'block') {
        form.scrollIntoView({ behavior: 'smooth' });
      }
    });

    document.getElementById('cancelResearch').addEventListener('click', function() {
      document.getElementById('researchForm').style.display = 'none';
      document.getElementById('addResearchForm').reset();
    });

    document.getElementById('addResearchForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const submitBtn = e.target.querySelector('button[type="submit"]');
      const originalText = submitBtn.textContent;
      submitBtn.disabled = true;
      submitBtn.textContent = 'Saving...';
      
      const data = {
        addedBy: currentUser.name,
        accountName: document.getElementById('accountName').value,
        category: document.getElementById('category').value,
        sourceType: document.getElementById('sourceType').value,
        outlierCategory: document.getElementById('outlierCategory').value,
        hook: document.getElementById('hook').value,
        topic: document.getElementById('topic').value,
        music: document.getElementById('music').value,
        brolls: document.getElementById('brolls').value,
        shootingStyle: document.getElementById('shootingStyle').value,
        whyOutperformed: document.getElementById('whyOutperformed').value,
        howRecreate: document.getElementById('howRecreate').value,
        reelLink: document.getElementById('reelLink').value,
        notes: document.getElementById('notes').value
      };
      
      try {
        console.log('Submitting research:', data);
        const result = await googleScriptRun('addResearch', data);
        console.log('Submit result:', result);
        
        if (result && result.success) {
          showMessage('Research added successfully! üéâ', 'success');
          document.getElementById('researchForm').style.display = 'none';
          document.getElementById('addResearchForm').reset();
          
          setTimeout(async () => {
            await loadData();
          }, 800);
        } else {
          showMessage(result.message || 'Error adding research', 'error');
        }
      } catch (error) {
        console.error('Submit error:', error);
        showMessage('Error: ' + error.toString(), 'error');
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = originalText;
      }
    });

    // Edit Item
    function editItem(id) {
      console.log('Edit item:', id);
      const item = researchData.find(i => i.id == id);
      console.log('Found item:', item);
      
      if (!item) {
        showMessage('Item not found', 'error');
        return;
      }
      
      document.getElementById('editItemId').value = item.id;
      document.getElementById('editAccountName').value = item.accountName || '';
      document.getElementById('editCategory').value = item.category || '';
      document.getElementById('editSourceType').value = item.sourceType || '';
      document.getElementById('editOutlierCategory').value = item.outlierCategory || '';
      document.getElementById('editHook').value = item.hook || '';
      document.getElementById('editTopic').value = item.topic || '';
      document.getElementById('editMusic').value = item.music || '';
      document.getElementById('editShootingStyle').value = item.shootingStyle || '';
      document.getElementById('editReelLink').value = item.reelLink || '';
      document.getElementById('editWhyOutperformed').value = item.whyOutperformed || '';
      document.getElementById('editHowRecreate').value = item.howRecreate || '';
      document.getElementById('editNotes').value = item.notes || '';
      document.getElementById('editStatus').value = item.status || 'Pending';
      
      document.getElementById('editModal').classList.add('active');
      document.body.style.overflow = 'hidden';
    }

    document.getElementById('closeEditModal').addEventListener('click', closeEditModal);
    document.getElementById('cancelEdit').addEventListener('click', closeEditModal);
    document.getElementById('editModal').addEventListener('click', function(e) {
      if (e.target === this) closeEditModal();
    });

    function closeEditModal() {
      document.getElementById('editModal').classList.remove('active');
      document.body.style.overflow = '';
    }

    document.getElementById('editResearchForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      const submitBtn = e.target.querySelector('button[type="submit"]');
      const originalText = submitBtn.textContent;
      submitBtn.disabled = true;
      submitBtn.textContent = 'Saving...';
      
      const data = {
        id: document.getElementById('editItemId').value,
        addedBy: currentUser.name,
        accountName: document.getElementById('editAccountName').value,
        category: document.getElementById('editCategory').value,
        sourceType: document.getElementById('editSourceType').value,
        outlierCategory: document.getElementById('editOutlierCategory').value,
        hook: document.getElementById('editHook').value,
        topic: document.getElementById('editTopic').value,
        music: document.getElementById('editMusic').value,
        shootingStyle: document.getElementById('editShootingStyle').value,
        reelLink: document.getElementById('editReelLink').value,
        whyOutperformed: document.getElementById('editWhyOutperformed').value,
        howRecreate: document.getElementById('editHowRecreate').value,
        notes: document.getElementById('editNotes').value,
        status: document.getElementById('editStatus').value
      };
      
      try {
        console.log('Updating research:', data);
        const result = await googleScriptRun('updateResearch', data);
        console.log('Update result:', result);
        
        if (result && result.success) {
          showMessage('Updated successfully!', 'success');
          closeEditModal();
          
          setTimeout(async () => {
            await loadData();
          }, 800);
        } else {
          showMessage(result.message || 'Error updating', 'error');
        }
      } catch (error) {
        console.error('Update error:', error);
        showMessage('Error: ' + error.toString(), 'error');
      } finally {
        submitBtn.disabled = false;
        submitBtn.textContent = originalText;
      }
    });

    // Delete Item
    async function deleteItem(id) {
      if (!confirm('Are you sure you want to delete this item?')) return;
      
      try {
        console.log('Deleting item:', id);
        const result = await googleScriptRun('deleteResearch', id, currentUser.name);
        console.log('Delete result:', result);
        
        if (result && result.success) {
          showMessage('Deleted successfully', 'success');
          
          setTimeout(async () => {
            await loadData();
          }, 800);
        } else {
          showMessage(result.message || 'Error deleting', 'error');
        }
      } catch (error) {
        console.error('Delete error:', error);
        showMessage('Error: ' + error.toString(), 'error');
      }
    }

    // Navigation
    document.querySelectorAll('.nav-item').forEach(item => {
      item.addEventListener('click', function() {
        switchPage(this.dataset.page);
      });
    });

    document.querySelectorAll('.btn[data-page]').forEach(btn => {
      btn.addEventListener('click', function() {
        switchPage(this.dataset.page);
      });
    });

    function switchPage(pageName) {
      console.log('Switching to page:', pageName);
      
      document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
      });
      const navItem = document.querySelector(`.nav-item[data-page="${pageName}"]`);
      if (navItem) navItem.classList.add('active');
      
      document.querySelectorAll('.page-section').forEach(section => {
        section.classList.remove('active');
      });
      const page = document.getElementById(`${pageName}Page`);
      if (page) page.classList.add('active');
    }

    // Search
    document.getElementById('searchResearch').addEventListener('input', function(e) {
      const query = e.target.value.toLowerCase();
      const rows = document.querySelectorAll('#researchTableBody tr');
      
      rows.forEach(row => {
        const text = row.textContent.toLowerCase();
        row.style.display = text.includes(query) ? '' : 'none';
      });
    });

    // Helper function to call Google Apps Script
    function googleScriptRun(functionName, ...args) {
      return new Promise((resolve, reject) => {
        try {
          google.script.run
            .withSuccessHandler(function(result) {
              console.log('‚úì Success:', functionName, result);
              resolve(result);
            })
            .withFailureHandler(function(error) {
              console.error('‚úó Error:', functionName, error);
              reject(error);
            })
            [functionName](...args);
        } catch (e) {
          console.error('‚úó Call error:', functionName, e);
          reject(e);
        }
      });
    }

    function showMessage(text, type) {
      const message = document.getElementById('message');
      if (!message) return;
      
      message.textContent = text;
      message.className = `message ${type} active`;
      
      setTimeout(() => {
        message.classList.remove('active');
      }, 5000);
    }

    // Refresh Research Button
    document.getElementById('refreshResearchBtn')?.addEventListener('click', async function() {
      this.disabled = true;
      this.textContent = '‚è≥ Loading...';
      
      try {
        await loadResearch();
        showMessage('Research refreshed!', 'success');
      } catch (error) {
        showMessage('Error refreshing', 'error');
      } finally {
        this.disabled = false;
        this.textContent = 'üîÅ Refresh';
      }
    });

    // Make functions globally accessible
    window.editItem = editItem;
    window.deleteItem = deleteItem;
  </script>
</body>

</html>
